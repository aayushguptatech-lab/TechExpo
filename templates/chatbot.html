<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Chatbot</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/chatbot.css') }}">
</head>
<body>

  <div class="top-bar">
        <span>Skip to Main Content | Screen Reader Access</span>
        <span style="float:right;">English | à¤¹à¤¿à¤‚à¤¦à¥€</span>
    </div>
    <div id="Nav-bar">
        <div id="logo-img"><img src="{{url_for('static', filename='images/icon.png')}}" alt="" height="80%"></div>
        <div id="logo"> <h2 style="font-style: bold; font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif; margin-left: 2px;">SevaKendra</h2></div>
            <div class="nav"><h3><a style="text-decoration: none;" href="{{ url_for('home' ) }}">Dashboard</a></h3></div>
            <div class="nav"><h3><a style="text-decoration: none;" href="{{ url_for('upload_report') }}">Report Analysis</a></h3></div>
            <div class="nav"><h3><a style="text-decoration: none;" href="{{ url_for('schemes') }}">Government Schemes</a></h3></div>
            <div class="nav"><h3><a style="text-decoration: none;" href="{{ url_for('health_camps') }}">Health Camps</a></h3></div>
            <div class="nav"><h3><a style="text-decoration: none;" href="{{ url_for('login') }}">Login</a></h3></div>
        
        <div class="login_button" style="padding-left: 90px;"><button style="height: 35px; width: 60px; background-color: rgb(246, 97, 97); font-style: bold; color: white; border-radius: 10px;"><a style="text-decoration: none; color: white;" href="{{ url_for('login') }}">Login</a></button></div>
    </div>




  <div class="chat-container">
    <div class="chat-header"><img style="height: 40px; width: 40px; background-color: white; border-radius: 10px; margin-top: 10px;"  src="{{ url_for('static', filename='images/icon.png') }}" alt=""> <h1 style="margin-bottom: 10px;">AI Chatbot</h1></div>

    <div class="chat-box" id="chatBox">
      <div class="bot-message message">Hello! ðŸ‘‹ How can I help you today?</div>
    </div>

    <div class="input-area">
      <input id="userInput" type="text" placeholder="Type a message..." />
      <button id="sendBtn">âž¤</button>
    </div>
  </div>

  <script>
    const sendBtn = document.getElementById("sendBtn");
    const userInput = document.getElementById("userInput");
    const chatBox = document.getElementById("chatBox");

    sendBtn.addEventListener("click", sendMessage);
    userInput.addEventListener("keypress", function(e) {
      if (e.key === "Enter") sendMessage();
    });

    async function sendMessage() {
      const message = userInput.value.trim();
      if (!message) return;

      // Show user's message
      const userMsgDiv = document.createElement("div");
      userMsgDiv.className = "user-message message";
      userMsgDiv.textContent = message;
      chatBox.appendChild(userMsgDiv);
      userInput.value = "";

      // Scroll to bottom
      chatBox.scrollTop = chatBox.scrollHeight;

      // Show "typing..." while waiting
      const botMsgDiv = document.createElement("div");
      botMsgDiv.className = "bot-message message";
      botMsgDiv.textContent = "Typing...";
      chatBox.appendChild(botMsgDiv);
      chatBox.scrollTop = chatBox.scrollHeight;

      // Send request to Flask
      const response = await fetch("/get", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: "msg=" + encodeURIComponent(message)
      });

      const botResponse = await response.text();
      botMsgDiv.textContent = botResponse;
      chatBox.scrollTop = chatBox.scrollHeight;
    }
  </script>
</body>
</html>
